#include "heads.h"

int establish_connection() {
  int fd;
  int fd1;
  srand((unsigned) time(NULL));
  int r = rand();
  char my_pipe[100];
  itoa(r, my_pipe, 10);
  fd1 = open(my_pipe, O_RDONLY);
  fd = open(WKP, O_WRONLY);
  write(fd, my_pipe, sizeof(my_pipe));
  char conf_rec[100];
  read(fd1, conf_rec, sizeof(conf_rec));
  char conf_send[100] = "confirmation recieved";
  write(fd, conf_send, sizeof(conf_send));
  char status[100];
  read(fd, status, sizeof(status));
  close(fd);
  printf("%s\n", status);
  if (strcmp(status, "succesfully established connection, waiting for second client...") == 0) {
    return 0; //tells the parent function to write in initial client-client connection
  }
  else {
    return 1; //tells the parent function to read in initial client-client connection
  }
  //INCOMPLETE NEEDS TO BE FINISHED AND DEBUGGED
}
